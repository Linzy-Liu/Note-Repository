# 目录

1. [引论](#1-引论)
2. [解方程](#2-解方程)



# 1. 引论

## 1.1 数值计算的误差

数值计算总是会存在误差的。这样的误差主要来源有两个：**固有误差**（来自模型、观测）、**计算误差**（来自截断，舍入）
因此，我们需要定量分析误差：

绝对误差
: 即数值解和真实解的距离的上界\[e^* = |x-x^*|\]

相对误差
: 我们对**相对误差**$e^*_r$有如下定义：\[e^*_r = \left|\frac{x-x^*}{x^*}\right|\]

有效数字
: 若$x^*$是某一位的半个单位，该位到$x^*$的第一个非零数字共有$n$个，则称$x^*$具有$n$个**有效数字**

* 例子：3.15作为$\pi$的估计具有2位有效数字，因为：\[0.5\times 10^{-2}<|3.15-\pi|<0.5\times 10^{-1}\]故3.15的有效位从$10^{-1}$开始算起

**Theorem**
有近似$x^* = 10^m\sum_{k=1}^n a_n\times 10^{-(n-1)}$,则：
1. 若$x^*$有$n$个有效数字，则\[e^*_r \leq \frac{1}{2a_1}\times 10^{-(n-1)}\]
2. 反之，若\[e^*_r \leq \frac{1}{2(a_1+1)}\times 10^{-(n-1)}\]则$x^*$至少有$n$个有效数字。

### 误差的四则运算

设$x_i^*$为$x_i$的误差，则：
1. 令$x_3 = x_1 \plusmn x_2$, 则$|x_3 - x_3^*| \leq |x_1-x_1^*| + |x_2-x_2^*|$
2. 令$x_3 = x_1 x_2$, 则$|x_3 - x_3^*| \leq |x_2^*||x_1-x_1^*| + |x_1^*||x_2-x_2^*|$
3. 令$x_3 = \frac{x_1}{x_2}$, 则\[|x_3 - x_3^*| \leq \frac{|x_2^*||x_1-x_1^*| + |x_1^*||x_2-x_2^*|}{|x_2||x_2^*|}\]

### 注意事项

1. 避免大数与小数直接相加
2. 避免大数除小数
3. 避免相近数相减（如$\sqrt{n+1} - \sqrt{n}$）
4. 减少运算次数

## 1.2 算法的评价指标

* **精确性**
* **可靠性**：误差是否可以由理论或数学证明。
* **复杂度**：一般来说分时间复杂度（计算次数）与空间复杂度（内存）。
* **稳定性**：若输入数据的微小变化会导致输出剧烈变化，那么这样的算法是不稳定的。

# 2. 解方程

## 2.1 二分法

“二分法”，顾名思义，是一个迭代的过程。通过测度不断缩小的开区间套逼近待求解。因此，该方法的关键是一个在每一次迭代确定新区间的方法。注意到：
> For an continuous function f on subset $E$ of $\mathbb{R}$, if there exists $a,b \in E$ with 
> \[f(a)f(b) < 0\] then there exists an $x$ with $f(x) = 0$.

因此，我们每次只需要在已有区间取中点即可。在区间长度达到终止条件后，解即为终止时所得区间的终点。

同时，对于一个定义在$[a,b]$的连续函数，我们的求解误差为：
\[\lVert x_c - r\rVert < \frac{b-a}{2^{n+1}}\] 其中$x_c$为事实解，$r$为数值解，$n$为迭代次数。

## 2.2 不动点迭代

望文生义，不动点即为满足$g(x)=x$的实数$x$。一般而言，我们采用不动点迭代来寻找不动点：
\[x_{n+1} = f(x_n)\]但这样的迭代并不总是收敛。
可以绘制**cobweb图**来直观地说明这一点。因此我们需要找到确保不动点迭代可行的前提。

### 2.1.1 敛散性

注意到：
> **压缩映像原理**
> 设$f$在$E \subset \mathbb{R}$上可微，且数列$\{x_n\}_{n=1}^\infty$由$x_{n+1} = f(x_n)$定义，若
> \[\sup |f'(x)| \leq r < 1\]则数列收敛。

# 3. 插值法

## 3.1 为什么需要插值法

> For a continuous function f defined on a section $[a,b]$, we have $n+1$ points satisfying 
> \[a=x_0<x_1 < \ldots < x_n = b\] and $y_i = f(x_i)$ for each $i$. Then we need a function $g$ which is close to $f$ and is easy to manipulate.

一般地来说，我们要求$g$至少满足$(f-g)(x_i) = 0$

## 3.2 多项式插值

我们在此记$F[x]_n$为以$x$为文字的，次数小于n的多项式全体。（或以$P_n$表示$<1,x,x^2,\ldots, x^n>$）

那么我们首先有以下定理：
> **Theorem 3.2.1**
> 对于给定的$n$个不同的点$x_i,\quad i=0,1,\ldots,n$和$y_i = f(x_i)$， 其插值多项式存在且唯一。

在说明多项式插值的存在性后，我们就可以着手考虑这样的多项式的具体形式了。于是我们接下来会介绍一个简洁的插值多项式。

### 3.2.1 拉格朗日插值函数

其思想是通过**基函数**来构造整个$n$阶插值函数。首先考虑其形式：
> 假定已知$n$个点：$y_i = f(x_i)$, $i=0,1,\ldots,n$, 那么
> $$
> \begin{align*}
>    & L_nf(x) = \sum_{i=1}^n \frac{y_i\,F(x)}{(x-x_i)F'(x_i)}\\
>    & F(x) = \prod_{i=1}^n (x-x_i)
> \end{align*}
> $$

接下来，我们将阐述产生这样的式子的思想：
我们希望这样的式子会有如下形式：
\[L_nf(x) = \sum_{i=1}^n y_il_i\]其中$l_i$是一个关于$x$的函数，满足
\[ l_i(x_j) = 
    \left\{
    \begin{align*}
    1,\quad & i=j \\
    0,\quad& i \not = j
    \end{align*}
    \right.
    \]
将任一$x_i$带入，可以发现$n$个零点，从而确定$l_i$的形式，再乘上某个常数，就可以满足$l_i$的定义。
接下来的步骤便是显然的。

#### 误差分析

> **Theorem 3.2.2**
> 设$f$在$[a,b]$上$n+1$阶连续可导，那么
> \[ f(x) - L_nf(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!}F(x)\]其中$F(x)$定义见*Lagrange插值多项式*定义。
>
> **Corollary**
> 令$M_{n+1} := \max_{a\leq x\leq b} \left| f^{(n+1)}(x)\right|$， 则
> \[ \left|f(x) - L_nf(x)\right| \leq \frac{M_{n+1}}{(n+1)!}\left|F(x)\right|\]
> 令$h := \max_{1\leq j\leq n}\left|x_j-x_{j-1}\right|$, 则
> \[ \left|f(x) - L_nf(x)\right| \leq \frac{h^{n+1}}{4(n+1)}M_{n+1}\]